# Project Summary

## What we have measured
- **Encoder energy:** `spicemodels/option-b-encoder-results.md` now lists sync/de-synced patterns plus low-, medium-, and high-activity decks. `Edyn` is leakage-corrected and scaled to slices/word (with per-transition normalization). The latest scaling model is `Eword ≈ Eleak + 0.33 pJ × transitions`.
- **Shared sense periphery:** `spicemodels/option-b-encoder-with-shared-sense*.spice` now runs across TT and ±10% VDD, aggregating four encoder outputs into a single comparator/driver. The TT deck reproduces `Edyn ≈ 0.45 pJ`, `Eslice ≈ 0.11 pJ`, and `Eword_est ≈ 4.86 pJ` while the ±10% corners stay in the 4–6 pJ window. We now sample `sense_headroom_min/max` from `sharedDriveDiff` so the low-swing window is recorded even though the rails never reach 0.5·VDD and the threshold probes still fail.
  - **Noise/driver notes:** Injecting ~5–10 mV of noise onto the shared rails stresses the headroom histogram so we can either catalog the surviving ~70–110 mV swing as a feature or log the extra energy/delay cost required to widen the driver.
  - **Monte Carlo spread:** Enabling the `MC_*` switches and running 50 seeds per corner at 0.9/1.0/1.1 V plus a matched TT sweep now yields `Edyn ≈ 0.313 pJ` (0.452 pJ at TT) and `Eword_est ≈ 3.37 pJ` (4.86 pJ at TT), but the driver headroom stays near ±0.3 mV at the ±10% corners (worst-case ±0.295 mV) and only the TT trace occasionally peaks near +24.62 mV. Every tuple and histogram now lives in `logs/mismatch-mc/mismatch_mc.csv` and `logs/mismatch-mc-tt/mismatch_mc_tt.csv`, keeping the kill-criterion ledger auditable even though the 20 mV guard is still unmet.
  - **Driver upsize log:** The `spicemodels/option-b-encoder-with-shared-sense-mismatch-upsized.spice` deck (DRIVER_WN=3u/WP=6u) reruns the same 50-seed sweep; the energy numbers barely change but the driver-node difference grows to ≈±0.416 mV, and every log is rolled into `logs/mismatch-mc-upsized/mismatch_mc.csv` via `tools/aggregate_mismatch_logs.py` so the new permutation is tracked before any larger level-restorer or upsizing is accepted.

-## Validation gaps
- The Monte Carlo ledger now holds both the baseline (`logs/mismatch-mc/mismatch_mc.csv`, `logs/mismatch-mc-tt/mismatch_mc_tt.csv`) and the upsized driver (`logs/mismatch-mc-upsized/mismatch_mc.csv`) sweeps, but the driver difference headroom still only reaches ≈±0.416 mV even with 1.5× sizing and the noise injection, so the 20 mV guard remains unsettled and the `td_*`/`settle_*` probes continue to fail.

## What’s next
1. Decide whether driver upsizing or level restoration is needed to move the shared driver’s headroom closer to the 20 mV guard before the failed `td_*`/`settle_*` probes can give useful latency numbers; the upsized logs now show ≈±0.416 mV so the guard is still missing.
2. Keep the ±10%/TT/MC measurements reflected in `models/periphery-cost-model.md`, `STATUS.md`, and this roadmap, pointing readers to `logs/mismatch-mc/mismatch_mc.csv`, `logs/mismatch-mc-tt/mismatch_mc_tt.csv`, and `logs/mismatch-mc-upsized/mismatch_mc.csv` for the histogram details.
3. Log any new shared-sense permutations (activity patterns, noise levels, driver sizing) so the kill-criterion ledger continues to document each energy/headroom experiment before tagging a candidate as ready for `spicemodels/`.
